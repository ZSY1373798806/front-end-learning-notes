## 🚀 打包部署

- **常见方案**：Webpack、Vite、Rollup、Rspack、Rsbuild
- **优化目标**
  - 产物瘦身（Tree-shaking、Code splitting、压缩混淆）
  - 静态资源优化（图片压缩、懒加载、CDN）
  - 缓存利用（hash、HTTP 缓存、Service Worker）

### ESLint & Prettier

| **特性**       | **ESLint**                          | **Prettier**                        | **协同价值**       |
| :------------- | :---------------------------------- | :---------------------------------- | :----------------- |
| **核心功能**   | 代码质量检查与错误检测              | 代码格式化与风格统一                | 质量+美观双保障    |
| **工作目标**   | 发现潜在错误，强制编码规范          | 自动格式化代码，统一视觉风格        | 错误预防+风格一致  |
| **规则类型**   | 可修复问题+不可修复问题             | 100%可自动修复的问题                | 全面覆盖修复场景   |
| **配置复杂度** | 高（数百条规则可配置）              | 低（约20个主要选项）                | 平衡灵活性与易用性 |
| **语言支持**   | JavaScript/TS为主，插件扩展其他语言 | 支持JS/TS/CSS/HTML/JSON/Markdown等  | 全栈覆盖           |
| **修复能力**   | 可修复部分问题                      | 可修复所有支持的问题                | 最大化自动修复范围 |
| **典型规则**   | `no-unused-vars`, `eqeqeq`          | `printWidth`, `semi`, `singleQuote` | 质量约束+视觉规范  |

### Husky 

- 是一个git钩子管理器，允许触发自定义脚本在git事件发生时允许；如pre-commit、pre-push、post-merge等
- 主要目的是自动化版本控制工作流程，例如在提交前运行代码检查、格式化代码或执行测试；以确保代码库的质量和一致性

### lint-staged

- lint-staged是允许在Husky钩子之上的工具，专门用于对暂存区（staged）文件的检查
- 当运行git commit并Husky触发pre-commit钩子时，lint-staged会检查即将提交的代码（即git add后的文件列表）；并运行配置好的检查脚本，如代码格式化程序、linter或其他工具
- 目的是确保在提交之前，只有没有检查错误的代码会被提交

### 配置Husky & lint-staged

- 安装依赖

  ```bash
  npm install commitizen cz-conventional-changelog @commitlint/cli @commitlint/config-conventional husky --save-dev
  ```

- 配置Commitizen

  ```json
  {
    "config": {
      "commitizen": {
        "path": "./node_modules/cz-conventional-changelog"
      }
    },
    "scripts": {
      "commit": "git-cz"
    }
  }
  ```

- 配置Husky钩子

  ```bash
  npx husky install
  npm pkg set scripts.prepare="husky install"
  ```

- 创建禁止直接 commit 的钩子 (核心)

  ```bash
  npx husky add .husky/pre-commit
  ```

  编辑.husky/pre-commit内容

  ```bash
  #!/bin/sh
  
  # 检查是否通过 commitizen 提交
  if [ -z "$CZ_TYPE" ]; then
    echo "Error: Direct 'git commit' is disabled. Use 'npm run commit' instead." >&2
    exit 1
  fi
  ```

- 配置 Commitizen 传递环境变量

  修改 `package.json` 中的 commit 脚本

  ```json
  {
    "scripts": {
      "commit": "CZ_TYPE=true git-cz"
    }
  }
  ```

- 配置 commitlint (可选但推荐)

  创建 `.commitlintrc.json`

  ```json
  {
    "extends": ["@commitlint/config-conventional"]
  }
  ```

  创建 `.husky/commit-msg`

  ```bash
  npx husky add .husky/commit-msg 'npx --no commitlint --edit "$1"'
  ```

### Axios

- #### 取消请求

  - CancelToken

    ```js
    import axios from 'axios';
    
    // 创建取消令牌源
    const CancelToken = axios.CancelToken;
    const source = CancelToken.source();
    
    // 发送请求
    axios.get('/api/data', {
      cancelToken: source.token
    }).catch(err => {
      if (axios.isCancel(err)) {
        console.log('请求取消:', err.message);
      } else {
        // 处理其他错误
      }
    });
    
    // 取消请求
    source.cancel('用户主动取消请求');
    ```

  - AbortController 

    ```js
    const controller = new AbortController();
    
    axios.get('/api/data', {
      signal: controller.signal
    }).catch(err => {
      if (err.name === 'AbortError') {
        console.log('请求取消');
      }
    });
    
    // 取消请求
    controller.abort();
    ```

    

## 🏗️ 最佳实践组合

1. **开发中**
   - ESLint + Prettier 实时检测（编辑器插件 + 保存自动修复）
   - Axios + AbortController 管理请求
2. **提交前**
   - Husky (pre-commit) + lint-staged → 只检查本次修改文件
   - Commitizen 统一交互式提交
   - Commitlint 校验提交规范
3. **打包部署**
   - Vite/webpack 打包优化
   - CI/CD 自动执行 Lint + Test
   - 部署前构建产物压缩、分发 CDN